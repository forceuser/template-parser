!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.parse=e():t.parse=e()}(window,function(){return function(t){var e={};function n(a){if(e[a])return e[a].exports;var r=e[a]={i:a,l:!1,exports:{}};return t[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,a){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:a})},n.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=7)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=s;function r(t){return["keyword","number","literal","string"].includes(t.type)}function o(t){return["operation",",",".",":","=>"].includes(t.type)}function s(t,e="root",n=!1,a=!1){const i=[];let c,l=!1;(t.children||[]).forEach((t,e)=>{if(["comment","linebreak",";"].includes(t.type))(";"===t.type||"linebreak"===t.type&&!l)&&(l=t.type);else{i.push(t);const e=c&&"brackets"!==c.type&&"{"===c.data.open;!c||";"!==l&&("linebreak"!==l||o(t)||o(c)||e)||(c.brk=!0),l=!1,c=t}});let d,u,f="";"brackets"!==t.type||n||(f+=t.data.open),c=null;let p,h=!1,g=!1,m=!1;return i.forEach((n,l)=>{const y=i[l+1];if("keyword"===n.type&&"function"===n.data.val){n.fn=!0,n.fnKeyword=!0;let t=i[l+1];t&&"literal"===t.type&&(t.fn=!0,t.fnName=!0,t=i[l+2]),t&&"brackets"===t.type&&(t.fn=!0,t.fnArgs=!0)}else y&&"=>"===y.type&&(n.fn=!0,n.fnArgs=!0);const x=l>=i.length-1,b=(n.type,!c||c.brk),v=["root","code"].includes(e),k=(c&&","===c.type||b)&&v,w=(c&&","===c.type||b)&&"brackets"===e,_=c&&(["operation",":"].includes(c.type)||"keyword"===c.type)&&!k,$=["literal","number","string"].includes(n.type)||!h&&g;(k||w)&&(m=!1),b&&(p&&(f+=p),p="",h="keyword"===n.type&&["const","let","var"].includes(n.data.val)),_&&m&&(g=!1),(h&&k||w)&&(g=!0),g&&$&&(m=!0),d||"destructuring"===e||!$||g||!_&&!k||(u=c,d=[]);let j=!1;if(d){const t=function(t){return["operation",",",":"].includes(t.type)}(n);if(j=!0,o(n)||d.push(n),n.brk||t||x){j=!t&&(n.brk||x);const e=u&&r(u)?" ":"";p+=e+function(t,e,n,a=!1){let r="",o=0,i=t[0]&&"literal"!==t[0].type;const c=e&&"operation"===e.type&&["++","--"].includes(e.data.val)||n&&"operation"===n.type&&["++","--","=","+=","-=","*=","/=","%=","**=","<<=",">>=",">>>=","&=","^=","|="].includes(n.data.val);a=a||c;let l=[];const d=(t,e,n,a)=>{let r="_$g(";const o=t[0];return i&&(t=t.slice(1)),r+=`[${t.map(u).join(",")}],`,r+=e?`[${n}],`:"null,",r+=i?"true,":"false,",i?(r+=`${u(o)},`,r+=a?"true":"false"):(r+=`()=>${o.data.val}`,a&&(r+=`,_$v=>${o.data.val}=_$v`)),r+=a?").val":")"},u=t=>t.data.val?"literal"===t.type?`"${t.data.val}"`:t.data.val:s(t,"code",!0);for(;o<t.length;){const e=t[o];"brackets"===e.type&&"("===e.data.open?(r=d(l,!0,s(e,"code",!0,a)),i=!0,l=[{data:{val:r}}]):(l.push(e),i=i||1===l.length&&"literal"!==e.type,o===t.length-1&&(r=i&&1===l.length?u(l[0]):d(l,!1,null,c))),o++}return r}(d,u,n),d=null}}else if("brackets"===n.type){const e=g&&(h||b&&"brackets"===t.type&&"("===t.data.open)&&["{","["].includes(n.data.open)?"destructuring":n.fnArgs?"brackets":"code";p+=s(n,e,null,a)}if(n.data.val&&!j){const t=c&&r(c)&&r(n);p+=(t?" ":"")+n.data.val}n.brk&&(p+=";\n"),c=n}),p&&(f+="root"!==e||h?p:"return "+p),"brackets"!==t.type||n||(f+=t.data.close),f}e.default=a},function(t,e,n){"use strict";function a(t,e){const n=t.split("\n").map(t=>t.length);let a=0,r=0;for(;a<e&&r<n.length;)a+=n[r],r++;return r-1}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default=class{constructor(t,e=0){this.text=t,this.idx=e,this.root={type:"root",children:[],start:e,end:t.length},this.stack=[this.root],this.copyStack=[],Object.defineProperty(this.stack,"empty",{get(){return 0===this.length}}),this.stack.last=(()=>this.stack[this.stack.length-1])}regexp(t,e=""){return new RegExp(t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),e)}add(t,e){const n=this,a=Object.assign({children:[],start:this.lastIdx,end:this.idx,data:{}},e,{type:t});return Object.defineProperty(a,"text",{get:()=>n.text.substring(a.start,a.end||n.text.length)}),this.node.children.push(a),a}start(...t){const e=this.add(...t);return this.stack.push(e),e.start=this.idx,e.lineStart=a(this.text,e.start),e.end=null,e}end(t){let e=this.stack.pop();return t&&(e=function t(e,n){return Object.keys(n).forEach(a=>{!e.hasOwnProperty(a)||"object"!=typeof e[a]||e[a]instanceof Array?e[a]=n[a]:t(e[a],n[a])}),e}(e,t)),e.end=this.idx,e.lineEnd=a(this.text,e.end),e}get(t,e=0){return 1===t?this.text.charAt(this.idx+e):this.text.substr(this.idx+e,t)}startCopy(){this.copyStack.push(this.idx)}endCopy(){const t=this.copyStack.pop();return this.text.substring(t,this.idx)}get node(){return this.stack[this.stack.length-1]}go(t=1){return this.lastIdx=this.idx,this.idx+=t,this.moved=!0,this}next(){return this.lastIdx=this.idx,this.moved?this.moved=!1:this.idx++,this}isEnd(){return this.idx>=this.text.length}match(t){const e=this.get();return t instanceof RegExp?e.match(t):e.startsWith(t)}get before(){return this.text.substr(0,this.idx)}precedes(t){const e=this.before;return t instanceof RegExp?e.match(t):e.endsWith(t)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){const e=new r.default(t),n={string(){if("string"===e.node.type){const t=e.node;if(e.match(e.node.data.quote)){const n=e.precedes(/(\\+)$/);if(!n||n&&n[1].length%2==0)return e.go().end(),t.data.val=t.text,!0}}else{const t=e.match(/^(["'`])/);if(t)return e.start("string",{data:{quote:t[1]}}),!0}},comment(){const t=e.match(/^(\/\/.*?)(?:$|\Z)/m)||e.match(/^(\/\*[\s\S]*?\*\/)/);if(t)return console.log("comment",t[1]),e.go(t[1].length).add("comment"),!0},keyword(){const t=e.match(o);t&&e.go(t[1].length).add("keyword",{data:{val:t[1]}})},brackets(){if("brackets"===e.node.type&&e.match(e.node.data.close))return e.go().end(),!0;const t=e.match(/^([\(\[\{])/);return t?(e.start("brackets",{data:{open:t[1],close:{"{":"}","(":")","[":"]"}[t[1]]}}),!0):void 0},dot(){const t=e.match(/^(\.+)/);if(t&&1===t[1].length)return e.go().add(".",{data:{val:"."}}),!0},comma(){if(e.match(","))return e.go().add(",",{data:{val:","}}),!0},colon(){if(e.match(":"))return e.go().add(":",{data:{val:":"}}),!0},semicolon(){if(e.match(";"))return e.go().add(";"),!0},arrow(){if(e.match("=>"))return e.go(2).add("=>",{data:{val:"=>"}}),!0},number(){const t=e.match(/^(\d+?\.?\d*)/);if(t)return e.go(t[1].length).add("number",{data:{val:t[1]}}),!0},literal(){const t=e.match(/^([a-z][a-z0-9]*)/i);if(t)return e.go(t[1].length).add("literal",{data:{val:t[1]}}),!0},operation(){const t=e.match(/^([^\s,;\])}a-z]+)/i);if(t)return e.go(t[1].length).add("operation",{data:{val:t[1]}}),!0},linebreak(){if(e.match(/^\n/))return e.go().add("linebreak"),!0}};for(;!e.isEnd();){switch(e.node.type){case"string":n.string();break;case"comment":break;default:[n.comment,n.string,n.linebreak,n.semicolon,n.number,n.keyword,n.brackets,n.colon,n.comma,n.dot,n.arrow,n.literal,n.operation].some(t=>t())}e.next()}return e};var a,r=(a=n(1))&&a.__esModule?a:{default:a};const o=new RegExp(`^(${["async","await","break","case","class","catch","const","continue","debugger","default","delete","do","else","enum","export","extends","finally","for","function","goto","if","import","in","instanceof","let","new","return","super","switch","this","throw","try","typeof","var","void","while","with","yield","implements","package","protected","static","interface","private","public","null","true","false","undefined"].join("|")})\\b`)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;const a=t=>null==t||"object"!=typeof t&&"function"!=typeof t;class r{constructor(t){this.stack=[].concat(t),this.get=this.get.bind(this),this.new=this.new.bind(this)}new(t){return new r([...this.stack,t||{}])}get(t,e,n,r,o){let s,i=0;if(n)s=r;else try{s=r(),!e&&"function"==typeof o&&t.length>1&&a(s)&&o(s={}),i=1}catch(t){}let c=s;if(0===i){let e=this.stack.length-1;const n=t[0];for(;e>=0;){if(n in this.stack[e]||0===e){c=this.stack[e];break}e--}}for(;i<t.length;){const e=t[i];if(s=c[e],o){if(i===t.length-1)return{get val(){return c[e]},set val(t){c[e]=t}};a(s)&&(s={},c[e]=s)}else if(a(s)&&i<t.length-1)return;c=s,i++}return i===t.length&&e&&"function"==typeof s?s.apply(c,e):s}}e.default=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o(n(2)),r=o(n(0));function o(t){return t&&t.__esModule?t:{default:t}}var s=function(t,e="root"){return function t(e){let n=0;let a;let r;let o=0;const s=[];for(;o<e.length;){const i=e[o],{data:l,type:d}=i;"tag"===i.type||"expression"===i.type&&l.control?a?("tag"===a.type?("tag"===d&&l.open&&l.tagName===a.data.tagName&&n++,"tag"===d&&l.close&&l.tagName===a.data.tagName&&n--):"expression"===d&&("#"===l.control?n++:"/"===l.control&&n--),0===n&&(s.push(c(a,t(e.splice(r+1,o-r-2)))),a=null,o=r)):"tag"===d?l.open?(a=i,r=o,n++):l.selfClosing&&s.push(c(i)):"expression"===d&&"#"===l.control&&(a=i,r=o,n++):0===n&&s.push(c(i)),o++}return s}(t)};e.default=s;const i={list:(t,e)=>(t=t.split(" "),`...((call) => ${(0,r.default)((0,a.default)(t[0]).root)})((${t[2]}) => ${e})`)},c=(t,e)=>"tag"===t.type?e&&e.length?`h("${t.data.tagName}", {}, [${e.join(", ")}])`:`h("${t.data.tagName}", {})`:"expression"===t.type?"#"===t.data.control?`${i[t.data.fn](t.data.args,e)}`:`h(null, null, ${(0,r.default)((0,a.default)(t.data.expression).root)})`:`h(null, null, "${(t.data.content||"").replace(/\s+/gim," ")}")`},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){const e=new r.default(t),n={startTag(){if(e.match("<")){const t=e.match(/^<([a-z](-?[a-z])*)/i);if(t){const n=t[1];return e.start("tag",{data:{tagName:n,open:!0}}),e.go(n.length+1),!0}{const t=e.match(/^<\/([a-z](-?[a-z])*)>/i);if(t){const n=t[1];return e.go(t[0].length).add("tag",{data:{tagName:n,close:!0}}),!0}}}},startComment(){if(e.match("\x3c!--"))return e.start("comment"),e.go(4),!0},endComment(){if(e.match("--\x3e"))return e.go(3).end(),!0},endTag:()=>e.match("/>")?(e.go(2).end({data:{selfClosing:!0}}),!0):e.match(">")?(e.go().end(),!0):void 0,startAttr(){const t=e.match(/^([@&$:][a-z]+)?:?([a-z-]+)?(?:=(["']))?/i);if(t&&t[0]){let[n,a,r,o]=t;const s=a?a[0]:null;return a&&(a=a.substr(1)),o?(e.start("attr",{data:{attr:r,prefix:a,prefixType:s,quote:o}}),e.go(n.length)):e.go(n.length).add("attr",{data:{attr:r,prefix:a,prefixType:s}}),!0}},attr(){e.match(o);if(["&","$","=",":"].includes(e.node.data.prefixType)){let t;e.startCopy();const n=`${e.node.data.quote}`;for(;!t&&!e.isEnd();)!(t=e.match(n))&&e.go();if(t){const t=e.endCopy();e.go(n.length).end({data:{expression:t}})}}else{const t=/^(("(?:[^"\\]|\\.)*")|('(?:[^'\\]|\\.)*'))/,n=e.go(-1).match(t);n&&(e.node.value=n[0],e.go(n[0].length).end())}},text(){const t=e.root.children[e.root.children.length-1];t&&"text"===t.type?(t.end=e.idx,t.data.content+=e.get(1)):e.go(1).add("text",{data:{content:e.get(1)}})},expression(){const t=e.match(new RegExp(`^${o}(#|/)?(.*?)${s}`));if(t){const{0:n,1:a,2:r}=t;let o,s;if("#"===a){const t=r.match(/^([a-z]+(?:-[a-z]*)*)\s?(.*)/i);o=t[1],s=t[2]}e.go(n.length).add("expression",{data:{expression:r,control:a,fn:o,args:s}})}}};for(;!e.isEnd();){switch(e.node.type){case"tag":e.node.data.open?[n.endTag,n.startAttr].some(t=>t()):n.endTag();break;case"attr":n.attr();break;case"comment":n.endComment();break;default:[n.startTag,n.startComment,n.expression,n.text].some(t=>t())}e.next()}return e};var a,r=(a=n(1))&&a.__esModule?a:{default:a};const o="{{",s="}}"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=c(n(2)),r=c(n(5)),o=c(n(0)),s=c(n(4)),i=c(n(3));function c(t){return t&&t.__esModule?t:{default:t}}var l={parseExpression:a.default,parseTpl:r.default,formatExpression:o.default,formatTpl:s.default,Scope:i.default};e.default=l},function(t,e,n){"use strict";t.exports=n(6).default}])});
//# sourceMappingURL=parse.js.map