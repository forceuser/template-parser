{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 64e83cd1edf14ee9781b","webpack:///./cjs-entry.js","webpack:///./index.js","webpack:///./parse-ctrl.js"],"names":["module","exports","require","default","parse","startExp","endExp","text","ctrl","ParseCtrl","startTag","match","tagName","start","data","open","go","length","matchClose","add","close","startComment","endComment","end","endTag","selfClosing","startAttr","full","prefix","attr","quote","matchExpr","startCopy","m","matcher","node","isEnd","expression","endCopy","stringRegex","value","lastNode","root","children","type","idx","content","get","RegExp","control","fn","args","some","p","next","stack","copyStack","Object","defineProperty","last","s","flags","replace","params","assign","lastIdx","substring","push","pop","shift","charAt","substr","moved","val","str","startsWith","compare","str1","str2","idx1","idx2","i","l1","l2"],"mappings":"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","file":"parse.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"parse\"] = factory();\n\telse\n\t\troot[\"parse\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 64e83cd1edf14ee9781b","module.exports = require(\"./index.js\").default;\n\n\n\n// WEBPACK FOOTER //\n// ./cjs-entry.js","import ParseCtrl from \"./parse-ctrl.js\";\n\nconst startExp = \"{{\";\nconst endExp = \"}}\";\n\nexport default function parse (text) {\n\tconst ctrl = new ParseCtrl(text);\n\tconst parse = {\n\t\tstartTag () {\n\t\t\tif (ctrl.match(\"<\")) {\n\t\t\t\tconst match = ctrl.match(/^<([a-z](-?[a-z])*)/i);\n\t\t\t\tif (match) {\n\t\t\t\t\tconst tagName = match[1];\n\t\t\t\t\tctrl.start(\"tag\", {data: {tagName, open: true}});\n\t\t\t\t\tctrl.go(tagName.length + 1);\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tconst matchClose = ctrl.match(/^<\\/([a-z](-?[a-z])*)>/i);\n\t\t\t\t\tif (matchClose) {\n\t\t\t\t\t\tconst tagName = matchClose[1];\n\t\t\t\t\t\tctrl.go(matchClose[0].length).add(\"tag\", {data: {tagName, close: true}});\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tstartComment () {\n\t\t\tif (ctrl.match(\"<!--\")) {\n\t\t\t\tctrl.start(\"comment\");\n\t\t\t\tctrl.go(4);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\t\tendComment () {\n\t\t\tif (ctrl.match(\"-->\")) {\n\t\t\t\tctrl.go(3).end();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\t\tendTag () {\n\t\t\tif (ctrl.match(\"/>\")) {\n\t\t\t\tctrl.go(2).end({data: {selfClosing: true}});\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse if (ctrl.match(\">\")) {\n\t\t\t\tctrl.go().end();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\t\tstartAttr () {\n\t\t\tconst match = ctrl.match(/^(@[a-z]+)?:?([a-z-]+)?(?:=([\"']))?/i);\n\t\t\tif (match && match[0]) {\n\t\t\t\tconst [full, prefix, attr, quote] = match;\n\t\t\t\tif (quote) {\n\t\t\t\t\tctrl.start(\"attr\", {data: {attr, prefix, quote}});\n\t\t\t\t\tctrl.go(full.length);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tctrl.go(full.length).add(\"attr\", {data: {attr, prefix}});\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t},\n\t\tattr () {\n\t\t\tconst matchExpr = ctrl.match(startExp);\n\t\t\tif (matchExpr) {\n\t\t\t\tctrl.go(startExp.length);\n\t\t\t\tctrl.startCopy();\n\t\t\t\tlet m;\n\t\t\t\tconst matcher = `${endExp}${ctrl.node.data.quote}`;\n\t\t\t\twhile (!m && !ctrl.isEnd()) {\n\t\t\t\t\tm = ctrl.match(matcher);\n\t\t\t\t\t!m && ctrl.go();\n\t\t\t\t}\n\t\t\t\tif (m) {\n\t\t\t\t\tconst expression = ctrl.endCopy();\n\t\t\t\t\tctrl.go(matcher.length).end({data: {expression}});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse {\n\t\t\t\t// parse string\n\t\t\t\tconst stringRegex = /^((\"(?:[^\"\\\\]|\\\\.)*\")|('(?:[^'\\\\]|\\\\.)*'))/;\n\t\t\t\tconst match = ctrl.go(-1).match(stringRegex);\n\t\t\t\tif (match) {\n\t\t\t\t\tctrl.node.value = match[0];\n\t\t\t\t\tctrl.go(match[0].length).end();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\ttext () {\n\t\t\tconst lastNode = ctrl.root.children[ctrl.root.children.length - 1];\n\t\t\tif (lastNode && lastNode.type === \"text\") {\n\t\t\t\tlastNode.end = ctrl.idx;\n\t\t\t\tlastNode.data.content += ctrl.get(1);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tctrl.go(1).add(\"text\", {data: {content: ctrl.get(1)}});\n\t\t\t}\n\t\t},\n\t\texpression () {\n\t\t\tconst match = ctrl.match(new RegExp(`^${startExp}(#|/)?(.*?)${endExp}`));\n\t\t\tif (match) {\n\t\t\t\tconst {\"0\": full, \"1\": control, \"2\": expression} = match;\n\t\t\t\tlet fn;\n\t\t\t\tlet args;\n\t\t\t\tif (control === \"#\") {\n\t\t\t\t\tconst match = expression.match(/^([a-z]+(?:-[a-z]*)*)\\s?(.*)/i);\n\t\t\t\t\tfn = match[1];\n\t\t\t\t\targs = match[2];\n\t\t\t\t}\n\t\t\t\tctrl.go(full.length).add(\"expression\", {data: {expression, control, fn, args}});\n\t\t\t}\n\t\t},\n\t};\n\n\twhile (!ctrl.isEnd()) {\n\t\tswitch (ctrl.node.type) {\n\t\t\tcase \"tag\": {\n\t\t\t\tif (ctrl.node.data.open) {\n\t\t\t\t\t[\n\t\t\t\t\t\tparse.endTag,\n\t\t\t\t\t\tparse.startAttr,\n\t\t\t\t\t].some(p => p());\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tparse.endTag();\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase \"attr\": {\n\t\t\t\tparse.attr();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase \"comment\": {\n\t\t\t\tparse.endComment();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdefault: {\n\t\t\t\t[\n\t\t\t\t\tparse.startTag,\n\t\t\t\t\tparse.startComment,\n\t\t\t\t\tparse.expression,\n\t\t\t\t\tparse.text,\n\t\t\t\t].some(p => p());\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tctrl.next();\n\t}\n\treturn ctrl;\n}\n\n\n// разбить на выражения игнорируя строки\n// определить правую и левую сторону выражения (const, let, var)\n// const a = b = c + 2;\n// находим начало литерала [a-z]\n// идем игнорируя строки пока [a-z]\n// x.y = a.b[c[\"x\"]].d(attrs)\n\n\n// create empty expression, clear $ concat \"x\"\n// >. push \"x\"\n// clear $ concat \"y\"\n// >= push \"y\", mark expression as \"set\"\n// create empty expression, clear $ concat \"a\"\n// >. push \"a\"\n// clear $ concat b\n// >[ push \"b\",\n// >\"c\" create new expression\n\n\n\n// (get, set, call) => set([\"x\", \"y\"], call(get([\"a\", \"b\", get([\"c\", \"x\"]), \"d\"])), get([\"attrs\"]))\n// parse expression\n\n\n\n// WEBPACK FOOTER //\n// ./index.js","export default class ParseCtrl {\n\tconstructor (text, idx = 0) {\n\t\tthis.text = text;\n\t\tthis.idx = idx;\n\t\tthis.root = {type: \"root\", children: [], start: idx, end: text.length};\n\t\tthis.stack = [this.root];\n\t\tthis.copyStack = [];\n\t\tObject.defineProperty(this.stack, \"empty\", {\n\t\t\tget () {\n\t\t\t\treturn this.length === 0;\n\t\t\t},\n\t\t});\n\t\tthis.stack.last = () => {\n\t\t\treturn this.stack[this.stack.length - 1];\n\t\t};\n\t}\n\tregexp (s, flags = \"\") {\n\t\treturn new RegExp(s.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, \"\\\\$&\"), flags);\n\t}\n\tadd (type, params) {\n\t\tconst ctrl = this;\n\t\tconst node = Object.assign({children: [], start: this.lastIdx, end: this.idx, data: {}}, params, {type});\n\t\tObject.defineProperty(node, \"text\", {\n\t\t\tget () {\n\t\t\t\treturn ctrl.text.substring(node.start, node.end || ctrl.text.length);\n\t\t\t},\n\t\t});\n\t\tthis.node.children.push(node);\n\t\treturn node;\n\t}\n\tstart (...args) {\n\t\tconst node = this.add(...args);\n\t\tthis.stack.push(node);\n\t\tnode.start = this.idx;\n\t\tnode.end = null;\n\t\treturn node;\n\t}\n\tend (params) {\n\t\tconst node = this.stack.pop();\n\t\tif (params) {\n\t\t\tObject.assign(node, params);\n\t\t}\n\t\tnode.end = this.idx;\n\t\treturn node;\n\t}\n\tget (length, shift = 0) {\n\t\tif (length === 1) {\n\t\t\treturn this.text.charAt(this.idx + shift);\n\t\t}\n\t\treturn this.text.substr(this.idx + shift, length);\n\t}\n\tstartCopy () {\n\t\tthis.copyStack.push(this.idx);\n\t}\n\tendCopy () {\n\t\tconst idx = this.copyStack.pop();\n\t\treturn this.text.substring(idx, this.idx);\n\t}\n\tget node () {\n\t\treturn this.stack[this.stack.length - 1];\n\t}\n\tgo (shift = 1) {\n\t\tthis.lastIdx = this.idx;\n\t\tthis.idx += shift;\n\t\tthis.moved = true;\n\t\treturn this;\n\t}\n\tnext () {\n\t\tthis.lastIdx = this.idx;\n\t\tif (!this.moved) {\n\t\t\tthis.idx++;\n\t\t}\n\t\telse {\n\t\t\tthis.moved = false;\n\t\t}\n\t\treturn this;\n\t}\n\tisEnd () {\n\t\treturn this.idx >= this.text.length;\n\t}\n\tmatch (val) {\n\t\tconst str = this.get();\n\t\tif (val instanceof RegExp) {\n\t\t\treturn str.match(val);\n\t\t}\n\t\treturn str.startsWith(val);\n\t}\n}\n\n\n\n\n\nfunction compare (str1, str2, idx1 = 0, idx2 = 0) {\n\tlet i = 0;\n\tconst l1 = str1.length;\n\tconst l2 = str2.length;\n\tif (l1 < l2 - idx2 + idx1) {\n\t\treturn false;\n\t}\n\n\twhile (i < l2) {\n\t\tif (str1[idx1 + i] !== str2[idx2 + i]) {\n\t\t\treturn false;\n\t\t}\n\t\ti++;\n\t}\n\treturn true;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./parse-ctrl.js"],"sourceRoot":""}